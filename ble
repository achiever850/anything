SELECT * FROM "reporting"."vw_dimretirementeligibility" LIMIT 1;

SELECT COUNT(*) AS column_count
FROM information_schema.columns
WHERE table_name = 'vw_dimretirementeligibility';


SELECT column_name, data_type
FROM information_schema.columns
WHERE table_name = 'vw_dimretirementeligibility';


4th----------------------------------------------


SELECT gvt_retire_plan, category
FROM "reporting"."vw_dimretirementeligibility"
WHERE gvt_retire_plan IN ('1', '2', '4', '5', '6', 'C', 'E', 'K', 'KR', 'KF', 'M', 'MR', 'MF', 'R', 'T');



SELECT birthdate, age, Age_group
FROM "reporting"."vw_dimretirementeligibility"
WHERE birthdate IN ('1950-01-01', '1970-01-01', '1990-01-01', '2000-01-01');


SELECT emplid, first_eligibility_date, Retirement_Eligible_Flag
FROM "reporting"."vw_dimretirementeligibility"
WHERE Retirement_Eligible_Flag IS NOT NULL;


8.-- Test cases with specific birthdates and service dates
SELECT *
FROM "reporting"."vw_dimretirementeligibility"
WHERE birthdate = '1955-01-01';  -- Adjust birthdate based on eligibility criteria

9. SELECT COUNT(*) AS null_count
FROM "reporting"."vw_dimretirementeligibility"
WHERE first_eligibility_date IS NULL OR emplid IS NULL;

10.-- Timing the execution of the view
EXPLAIN ANALYZE SELECT * FROM "reporting"."vw_dimretirementeligibility";


11.SELECT COUNT(*) AS null_count
FROM "reporting"."vw_dimretirementeligibility"
WHERE retirementeligibilitysid IS NULL OR emplid IS NULL OR first_eligibility_date IS NULL;

12.SELECT COUNT(*) AS null_count
FROM "reporting"."vw_dimretirementeligibility"
WHERE retirementeligibilitysid IS NULL OR emplid IS NULL OR first_eligibility_date IS NULL;


13.SELECT emplid, birthdate, age
FROM "reporting"."vw_dimretirementeligibility"
WHERE birthdate IN ('1950-01-01', '1980-01-01', '1995-01-01', '2005-01-01');


14.
SELECT emplid, first_eligibility_date, Retirement_Eligible_Flag
FROM "reporting"."vw_dimretirementeligibility"
WHERE first_eligibility_date BETWEEN CURRENT_DATE - INTERVAL '30 days' AND CURRENT_DATE + INTERVAL '30 days';

15.
SELECT emplid, gvt_type_of_appt, Retirement_Eligible_Flag
FROM "reporting"."vw_dimretirementeligibility"
WHERE gvt_type_of_appt IN ('Full-time', 'Part-time', 'Temporary');


16.
SELECT emplid, first_eligibility_date, first_eligibility_type
FROM "reporting"."vw_dimretirementeligibility"
WHERE first_eligibility_type IS NOT NULL;

17.
SELECT emplid, gvt_retire_plan, first_eligibility_date, first_eligibility_type
FROM "reporting"."vw_dimretirementeligibility"
WHERE gvt_retire_plan IN ('K', 'M', '1') AND first_eligibility_date IS NOT NULL;


18.

EXPLAIN ANALYZE SELECT * FROM "reporting"."vw_dimretirementeligibility";


19.
SELECT emplid, gvt_effdt, first_eligibility_date
FROM "reporting"."vw_dimretirementeligibility"
WHERE gvt_effdt < CURRENT_DATE;


20.
SELECT emplid, COUNT(*) AS count
FROM "reporting"."vw_dimretirementeligibility"
GROUP BY emplid
HAVING COUNT(*) > 1;

21.
SELECT gvt_retire_plan, COUNT(*) AS count, AVG(age) AS avg_age
FROM "reporting"."vw_dimretirementeligibility"
GROUP BY gvt_retire_plan
ORDER BY count DESC;

22.
SELECT f.emplid, e.GVT_SCD_RETIRE, gp.birthdate
FROM datawarehouse.hrsmart_factpsgvtjob f
LEFT JOIN datawarehouse.hrsmart_dimpsgvtemployment e ON f.dimpsgvtemploymentid = e.dimpsgvtemploymentid
LEFT JOIN datawarehouse.hrsmart_dimpsgvtpersdata gp ON f.dimpsgvtpersdataid = gp.dimpsgvtpersdataid
WHERE f.emplid IN (SELECT emplid FROM "reporting"."vw_dimretirementeligibility");


23.
SELECT emplid, birthdate, age
FROM "reporting"."vw_dimretirementeligibility"
WHERE birthdate IN ('1984-02-29', '1976-02-29', '2000-02-29');


24.
SELECT emplid, first_eligibility_date, Retirement_Eligible_Flag
FROM "reporting"."vw_dimretirementeligibility"
WHERE (first_eligibility_date <= CURRENT_DATE AND Retirement_Eligible_Flag = 'YES') OR
      (first_eligibility_date > CURRENT_DATE AND Retirement_Eligible_Flag = 'NO');


25.

SELECT category, COUNT(*) AS count
FROM "reporting"."vw_dimretirementeligibility"
GROUP BY category;
