SELECT EMPLID, CATEGORY, AGE_GROUP
FROM (
    SELECT EMPLID, CATEGORY, AGE_GROUP
    FROM CTE_DETAIL
    WHERE RETIREMENT_ELIGIBLE_FLAG = 'YES'
) AS ELIGIBLE

UNION ALL

SELECT EMPLID, CATEGORY, AGE_GROUP
FROM (
    SELECT EMPLID, CATEGORY, AGE_GROUP
    FROM CTE_DETAIL
    WHERE RETIREMENT_ELIGIBLE_FLAG IS NULL
) AS NULL_ELIGIBLE

UNION ALL

SELECT EMPLID, 'NON-ELIGIBLE' AS CATEGORY, AGE_GROUP
FROM (
    SELECT EMPLID, AGE_GROUP
    FROM CTE_DETAIL
    WHERE RETIREMENT_ELIGIBLE_FLAG = 'NO'
) AS NON_ELIGIBLE

UNION ALL

SELECT EMPLID, 'TOTAL ACTIVE EMPLOYEE' AS CATEGORY, AGE_GROUP
FROM (
    SELECT EMPLID, AGE_GROUP
    FROM CTE_DETAIL
) AS TOTAL_ACTIVE

ORDER BY CATEGORY, AGE_GROUP;
